# Abundance and AMR Genes Annotation Analyses in R

This sesion focuses on exploring microbial community structure using abundance data and performing a descriptive analysis of antimicrobial resistance (AMR) gene annotations. We will use R and RStudio for data processing and visualization. The following R packages will be utilized:

- **phyloseq**: Integrates various types of microbiome data into a single object and provides tools for ecological and phylogenetic analysis.
  - Install using:
  ```
  if(!requireNamespace("BiocManager")){
    install.packages("BiocManager")
  }
  BiocManager::install("phyloseq")
  ```
- **ggplot2**: Used to create high-quality and customizable visualizations.
  - Install using: <br>
  `install.packages("ggplot2")` 
- **RColorBrewer**: Offers a set of color palettes for plots.
  - Install using: <br>
`install.packages("RColorBrewer")` 
- **dplyr**: Provides tools for data manipulation such as filtering, grouping, and summarizing.
  - Install using: <br>
`install.packages("tidyverse")`
- **stringr**: Simplifies string manipulation.
  - *stringr is included when you install tidyverse.* 

---
To perform the ecological and AMR gene analyses, you will need four input files in `.csv` format. These files will be provided by your instructor; however, the scripts used to generate them are available at `/hpcfs/home/cursos/bioinf-cabana/cabana_workshop/helper_scripts` for your reference. These files can be found at `/hpcfs/home/cursos/bioinf-cabana/cabana_workshop/final_tables`.

Below is a description of each required file:

1. **Abundance table** (`merged_abundance.csv`): Contains abundance estimates of all MAGs per sample. Row names are sample IDs and column names are MAG IDs. It was generated by using the script `merge_abundance_tables.py`.
2. **Sample metadata table** (`consolidate_metadata.csv`): Includes metadata for all analyzed samples, such as sampling location, BMI, sex, and others.
3. **Taxonomy table** (`all_MAGs_taxonomy.csv`): Contains the taxonomy information for the representative MAGs. It was generated using the script `create_tax_table.py`.
4. **MAGs AMR genes annotation table** (`all_AMR_genes.csv`): Contains AMR genes annotation data for the representative MAGs, along with their associated taxonomy. It was generated using the script `merge_amr_tables.py`.

**You can access and download the R scripts used for each analysis from the links below**:

**Ecological Analysis**:
[R Notebook](https://github.com/mariasotor/Cabana-Metagenomics-Workshop/blob/main/course_materials/Sesion3/ecological_analysis.html)

**AMR genes Annotation Analysis**:
[R Notebook](https://github.com/mariasotor/Cabana-Metagenomics-Workshop/blob/main/course_materials/Sesion3/amr_genes_analysis.html)


